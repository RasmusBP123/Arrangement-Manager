@page "/events"
@inherits FluxorComponent
@inject IDispatcher Dispatcher
@inject IState<GetActiveEventsState> EventState
@inject HttpClient HttpClient
@inject EventStore EventStore


@if(EventStore.Events != null)
{
    @foreach (var _event in EventStore.Events)
    {
        <p>@_event.Price</p>
        <p>@_event.Name</p>
        <p>@_event.Region.Name</p>
    }
}

@code {

    protected override async Task OnInitializedAsync()
    {
        EventStore.Events = await HttpClient.GetJsonAsync<List<GetEventListViewModel>>("api/events/active");
        EventStore.OnChange += StateHasChanged;
        //Dispatcher.Dispatch(new GetActiveEventsAction());
    }
}
