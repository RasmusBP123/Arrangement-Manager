@page "/"
@inject AuthStore AuthStore
@inject HttpClient HttpClient
@inject EventStore  EventStore

    <div class="index-container">
        <MatButton Raised="true" @onclick="@(() => SendMail())">Send email</MatButton>
        <Regions />
        <Events />
    </div>

@code{
    protected override async Task OnInitializedAsync()
    {
        try
        {
            AuthStore.User = await HttpClient.GetJsonAsync<UserModel>("api/accounts/user");
            if (AuthStore.User.Email != "")
            {
                AuthStore.NotifyLogin();
            }
        }
        catch { }
    }

    private void SendMail()
    {
        var email = AuthStore.User.Email;
        HttpClient.PostAsync($"api/mail/send/{email}", null);
    }
}